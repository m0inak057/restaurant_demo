{% extends "core/base.html" %}

{% block title %}Track Order #{{ order.id }}{% endblock %}

{% block content %}
  <section class="mb-6 flex flex-wrap items-center justify-between gap-3">
    <div>
      <p class="text-[11px] uppercase tracking-[0.2em] text-slate-400">
        Table {{ order.table.table_number }}
      </p>
      <h1 class="mt-1 text-xl font-semibold text-slate-50">
        Order #{{ order.id }}
      </h1>
      <p class="mt-1 text-xs text-slate-400">
        Share this screen with the guest so they can follow along.
      </p>
    </div>
  </section>

  <section class="grid gap-6 md:grid-cols-[minmax(0,1.4fr)_minmax(0,1fr)]">
    <article class="glass-card p-5">
      <h2 class="text-sm font-semibold text-slate-50">Items</h2>
      <ul class="mt-3 space-y-2 text-xs text-slate-200">
        {% for item in order.items.all %}
        <li
          class="flex items-start justify-between gap-3 rounded-xl bg-slate-900/70 px-3 py-2"
        >
          <div>
            <p class="font-semibold">
              {{ item.quantity }} × {{ item.menu_item.name }}
            </p>
            {% if item.custom_notes %}
            <p class="mt-0.5 text-[11px] text-slate-400">
              Note: {{ item.custom_notes }}
            </p>
            {% endif %}
          </div>
          <p class="text-xs text-emerald-300">₹ {{ item.line_total }}</p>
        </li>
        {% empty %}
        <li class="text-xs text-slate-400">No items recorded.</li>
        {% endfor %}
      </ul>
      <div
        class="mt-4 flex items-center justify-between border-t border-white/10 pt-3 text-sm"
      >
        <span class="text-slate-400">Total</span>
        <span class="font-semibold text-slate-50">₹ {{ order.total_price }}</span>
      </div>
    </article>

    <aside class="glass-card flex flex-col justify-between p-5">
      <div>
        <h2 class="text-sm font-semibold text-slate-50">Kitchen status</h2>
        <ol class="mt-4 space-y-3 text-xs text-slate-300">
          <li class="flex items-center gap-3">
            <span
              class="flex h-6 w-6 items-center justify-center rounded-full border text-[11px]
              {% if order.status in ('received','preparing','ready','served','closed') %}
              border-emerald-400 bg-emerald-500/10 text-emerald-300
              {% else %}
              border-slate-600 text-slate-400
              {% endif %}"
            >
              1
            </span>
            <div>
              <p class="font-medium">Order received</p>
              <p class="text-[11px] text-slate-400">
                Ticket created and sent to the kitchen.
              </p>
            </div>
          </li>
          <li class="flex items-center gap-3">
            <span
              class="flex h-6 w-6 items-center justify-center rounded-full border text-[11px]
              {% if order.status in ('preparing','ready','served','closed') %}
              border-emerald-400 bg-emerald-500/10 text-emerald-300
              {% else %}
              border-slate-600 text-slate-400
              {% endif %}"
            >
              2
            </span>
            <div>
              <p class="font-medium">Preparing</p>
              <p class="text-[11px] text-slate-400">
                Chefs are working on your dishes.
              </p>
            </div>
          </li>
          <li class="flex items-center gap-3">
            <span
              class="flex h-6 w-6 items-center justify-center rounded-full border text-[11px]
              {% if order.status in ('ready','served','closed') %}
              border-emerald-400 bg-emerald-500/10 text-emerald-300
              {% else %}
              border-slate-600 text-slate-400
              {% endif %}"
            >
              3
            </span>
            <div>
              <p class="font-medium">Ready to serve</p>
              <p class="text-[11px] text-slate-400">
                Plates are ready at the pass.
              </p>
            </div>
          </li>
          <li class="flex items-center gap-3">
            <span
              class="flex h-6 w-6 items-center justify-center rounded-full border text-[11px]
              {% if order.status in ('served','closed') %}
              border-emerald-400 bg-emerald-500/10 text-emerald-300
              {% else %}
              border-slate-600 text-slate-400
              {% endif %}"
            >
              4
            </span>
            <div>
              <p class="font-medium">Served &amp; enjoying</p>
              <p class="text-[11px] text-slate-400">
                Bon appétit! Staff can now close the table.
              </p>
            </div>
          </li>
        </ol>
      </div>
      <p class="mt-4 text-[11px] text-slate-500">
        This screen will be wired to live WebSocket updates in the KDS phase.
      </p>
    </aside>
  </section>
{% endblock %}
